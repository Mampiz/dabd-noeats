---
import {type Plato} from "../types/apiusers.ts";
import CardFood from "./CardFood.astro";

async function fetchPlatos(): Promise<Plato[]> {
	const response = await fetch("http://localhost:3000/platos", {
		method: "GET"
	});

	if (!response.ok) {
		throw new Error("Failed to fetch");
	}

	return response.json();
}

let platos: Plato[] = [];
try {
	platos = await fetchPlatos();
	console.log(platos);
} catch (error) {
	console.error("Error fetching clients:", error);
}

// Ejecutamos la función y esperamos los datos
---

<!-- Componente de visualización de clientes -->
<div class="grid gap-12 sm:grid-cols-2 lg:grid-cols-3">
	{platos.map(plato => <CardFood nom={plato.nom} descripcio={plato.descripcio} preu={plato.preu} />)}
</div>
